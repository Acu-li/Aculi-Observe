<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Acu.li Observe</title>
    <style>
        body {
            background:#3a3a3a;
            color:#fff;
            font-family:Arial, sans-serif;
            margin:0;
            padding:0;
        }
        .wrapper {
            width:80%;
            margin:0 auto;
        }
        h1 {
            text-align:center;
            margin:20px 0;
        }
        .tabs {
            display:flex;
            margin:0;
            padding:0 10px;
            list-style:none;
            overflow:hidden;
        }
        .tabs li {
            display:flex;
            justify-content:space-between;
            align-items:center;
            min-width:200px;
            background:linear-gradient(#666, #444);
            padding:10px 20px;
            margin:0 5px;
            border-radius:12px 12px 0 0;
            cursor:pointer;
            box-shadow:0 4px 6px rgba(0,0,0,0.4);
            user-select:none;
        }
        .tabs li.selected {
            background:linear-gradient(#888, #666);
        }
        .tabs li span.ip {
            font-size:0.9em;
            color:#ddd;
            margin-left:15px;
        }
        .tab-content {
            padding:20px;
            background:#555;
            border-radius:0 12px 12px 12px;
            box-shadow:0 4px 10px rgba(0,0,0,0.4);
            width:100%;
            margin:auto;
            opacity:0;
            transform:translateX(100%);
            transition:opacity 0.5s, transform 0.5s;
            pointer-events:none;
        }
        .tab-content.active {
            opacity:1;
            transform:translateX(0);
            pointer-events:auto;
        }
        table {
            width:60%;
        }
        td {
            padding:4px 8px;
        }
        .container {
            display:flex;
            justify-content:space-between;
            margin:15%;
        }
        .image-section {
            width:35%;
            text-align:center;
        }
        img {
            max-width:100%;
            box-shadow:0 4px 8px rgba(0,0,0,0.5);
        }
        input, button {
            background:#666;
            border:none;
            color:#fff;
            padding:6px 10px;
            border-radius:4px;
            margin-top:5px;
        }
    </style>
</head>
<body>
    <div class="wrapper">
    <h1>Acu.li Observe</h1>
    <ul class="tabs" id="tabs">
        {% for name, data in devices.items() %}
        <li onclick="showTab('{{ name }}')" data-name="{{ name }}"><span>{{ name }}</span><span class="ip">{{ data.ip }}</span></li>
        {% endfor %}
    </ul>
    {% for name, data in devices.items() %}
    <div class="tab-content" id="tab-{{ name }}">
        <h2>{{ name }} <span class="ip">{{ data.ip }}</span></h2>
        <div class="container">
            <div>
                <table>
                    {% for key, value in data.metrics.items() %}
                    <tr><td>{{ key }}</td><td>{{ value }}</td></tr>
                    {% endfor %}
                </table>
            </div>
            <div class="image-section">
                {% if data.image %}
                <img src="{{ url_for('static', filename='uploads/' + data.image) }}"/>
                {% endif %}
                <form action="/upload/{{ name }}" method="post" enctype="multipart/form-data">
                    <input type="file" name="image" accept="image/*" required spellcheck="false">
                    <button type="submit">Upload</button>
                </form>
                <p>{{ data.info }}</p>
            </div>
        </div>
    </div>
    {% endfor %}
    </div>
    <script>
        const tabs = document.querySelectorAll('.tabs li');
        const contents = document.querySelectorAll('.tab-content');
        let current = 0;
        function showTab(name){
            contents.forEach(c=>c.classList.remove('active'));
            tabs.forEach(t=>t.classList.remove('selected'));
            document.getElementById('tab-'+name).classList.add('active');
            const tab = Array.from(tabs).find(t=>t.dataset.name===name);
            if(tab) tab.classList.add('selected');
            current = Array.from(tabs).indexOf(tab);
        }
        function cycle(){
            if(tabs.length===0)return;
            current=(current+1)%tabs.length;
            const name=tabs[current].dataset.name;
            showTab(name);
        }
        setInterval(cycle,5000);
        if(tabs.length>0){
            const first=tabs[0].dataset.name;
            showTab(first);
        }
    </script>
</body>
</html>
